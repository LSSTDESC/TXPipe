<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>maps &mdash; TXPipe  documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Auxilliary maps" href="auxiliary_maps.html" />
    <link rel="prev" title="photoz_stack" href="photoz_stack.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> TXPipe
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">TXPipe Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="running.html">Running a pipeline:</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="stages.html">Stages implemented in TX-Pipe:</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="stages.html#the-base-stage">The base stage:</a></li>
<li class="toctree-l2"><a class="reference internal" href="stages.html#ingestion-stages">Ingestion stages:</a></li>
<li class="toctree-l2"><a class="reference internal" href="stages.html#selection-and-tomography-stages">Selection and Tomography stages:</a></li>
<li class="toctree-l2"><a class="reference internal" href="stages.html#photoz-stages">Photoz stages:</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="stages.html#maps-and-mask-stages">Maps and Mask stages:</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="auxiliary_maps.html">Auxilliary maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="noise_maps.html">noise_maps</a></li>
<li class="toctree-l3"><a class="reference internal" href="masks.html">masks</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="stages.html#two-point-stages">Two point stages:</a></li>
<li class="toctree-l2"><a class="reference internal" href="stages.html#plotting-and-diagnostics">Plotting and diagnostics:</a></li>
<li class="toctree-l2"><a class="reference internal" href="stages.html#extra-utilities">Extra utilities</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="submodules.html">Submodules for TXPipe</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">TXPipe</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="stages.html">Stages implemented in TX-Pipe:</a> &raquo;</li>
      <li>maps</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/maps.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <div class="section" id="module-txpipe.maps">
<span id="maps"></span><h1>maps<a class="headerlink" href="#module-txpipe.maps" title="Permalink to this headline">¶</a></h1>
<dl class="class">
<dt id="txpipe.maps.TXBaseMaps">
<em class="property">class </em><code class="sig-prename descclassname">txpipe.maps.</code><code class="sig-name descname">TXBaseMaps</code><span class="sig-paren">(</span><em class="sig-param">args</em>, <em class="sig-param">comm=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXBaseMaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXBaseMaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="base_stage.html#txpipe.base_stage.PipelineStage" title="txpipe.base_stage.PipelineStage"><code class="xref py py-class docutils literal notranslate"><span class="pre">txpipe.base_stage.PipelineStage</span></code></a></p>
<p>This is an abstract base mapping class, which other subclasses
inherit from to use the same basic structure, which is:
- select pixelization
- prepare some mapper objects
- iterate through selected columns</p>
<blockquote>
<div><ul class="simple">
<li><p>update each mapper with each chunk</p></li>
</ul>
</div></blockquote>
<ul class="simple">
<li><p>finalize the mappers</p></li>
<li><p>save the maps</p></li>
</ul>
<dl class="method">
<dt id="txpipe.maps.TXBaseMaps.accumulate_maps">
<code class="sig-name descname">accumulate_maps</code><span class="sig-paren">(</span><em class="sig-param">pixel_scheme</em>, <em class="sig-param">data</em>, <em class="sig-param">mappers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXBaseMaps.accumulate_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXBaseMaps.accumulate_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to supply the next chunk “data” to
their mappers</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXBaseMaps.choose_pixel_scheme">
<code class="sig-name descname">choose_pixel_scheme</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXBaseMaps.choose_pixel_scheme"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXBaseMaps.choose_pixel_scheme" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses can override to instead load pixelization
from an existing map</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXBaseMaps.data_iterator">
<code class="sig-name descname">data_iterator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXBaseMaps.data_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXBaseMaps.data_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to create an iterator looping over
input data</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXBaseMaps.finalize_mappers">
<code class="sig-name descname">finalize_mappers</code><span class="sig-paren">(</span><em class="sig-param">pixel_scheme</em>, <em class="sig-param">mappers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXBaseMaps.finalize_mappers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXBaseMaps.finalize_mappers" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to finalize their maps and return
a dictionary of (output_tag, map_name) -&gt; (pixels, values)</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXBaseMaps.prepare_mappers">
<code class="sig-name descname">prepare_mappers</code><span class="sig-paren">(</span><em class="sig-param">pixel_scheme</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXBaseMaps.prepare_mappers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXBaseMaps.prepare_mappers" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to init any mapper objects</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXBaseMaps.save_maps">
<code class="sig-name descname">save_maps</code><span class="sig-paren">(</span><em class="sig-param">pixel_scheme</em>, <em class="sig-param">maps</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXBaseMaps.save_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXBaseMaps.save_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses can use this directly, by generating maps as described
in finalize_mappers</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="txpipe.maps.TXDensityMaps">
<em class="property">class </em><code class="sig-prename descclassname">txpipe.maps.</code><code class="sig-name descname">TXDensityMaps</code><span class="sig-paren">(</span><em class="sig-param">args</em>, <em class="sig-param">comm=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXDensityMaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXDensityMaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="base_stage.html#txpipe.base_stage.PipelineStage" title="txpipe.base_stage.PipelineStage"><code class="xref py py-class docutils literal notranslate"><span class="pre">txpipe.base_stage.PipelineStage</span></code></a></p>
<p>Convert n_gal maps to overdensity delta maps
delta = (ngal - &lt;ngal&gt;) / &lt;ngal&gt;</p>
<p>This has to be separate from the lens mappers above
because it requires the mask, which is created elsewhere
(right now in masks.py)</p>
</dd></dl>

<dl class="class">
<dt id="txpipe.maps.TXExternalLensMaps">
<em class="property">class </em><code class="sig-prename descclassname">txpipe.maps.</code><code class="sig-name descname">TXExternalLensMaps</code><span class="sig-paren">(</span><em class="sig-param">args</em>, <em class="sig-param">comm=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXExternalLensMaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXExternalLensMaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#txpipe.maps.TXLensMaps" title="txpipe.maps.TXLensMaps"><code class="xref py py-class docutils literal notranslate"><span class="pre">txpipe.maps.TXLensMaps</span></code></a></p>
<p>Same as TXLensMaps except it reads from an external
lens catalog.</p>
<dl class="method">
<dt id="txpipe.maps.TXExternalLensMaps.data_iterator">
<code class="sig-name descname">data_iterator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXExternalLensMaps.data_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXExternalLensMaps.data_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to create an iterator looping over
input data</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="txpipe.maps.TXLensMaps">
<em class="property">class </em><code class="sig-prename descclassname">txpipe.maps.</code><code class="sig-name descname">TXLensMaps</code><span class="sig-paren">(</span><em class="sig-param">args</em>, <em class="sig-param">comm=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXLensMaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXLensMaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#txpipe.maps.TXBaseMaps" title="txpipe.maps.TXBaseMaps"><code class="xref py py-class docutils literal notranslate"><span class="pre">txpipe.maps.TXBaseMaps</span></code></a></p>
<p>Make galaxy number count maps from photometry
and lens tomography.</p>
<p>Density maps are made later once masks are generated.</p>
<dl class="method">
<dt id="txpipe.maps.TXLensMaps.accumulate_maps">
<code class="sig-name descname">accumulate_maps</code><span class="sig-paren">(</span><em class="sig-param">pixel_scheme</em>, <em class="sig-param">data</em>, <em class="sig-param">mappers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXLensMaps.accumulate_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXLensMaps.accumulate_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to supply the next chunk “data” to
their mappers</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXLensMaps.data_iterator">
<code class="sig-name descname">data_iterator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXLensMaps.data_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXLensMaps.data_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to create an iterator looping over
input data</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXLensMaps.finalize_mappers">
<code class="sig-name descname">finalize_mappers</code><span class="sig-paren">(</span><em class="sig-param">pixel_scheme</em>, <em class="sig-param">mappers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXLensMaps.finalize_mappers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXLensMaps.finalize_mappers" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to finalize their maps and return
a dictionary of (output_tag, map_name) -&gt; (pixels, values)</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXLensMaps.prepare_mappers">
<code class="sig-name descname">prepare_mappers</code><span class="sig-paren">(</span><em class="sig-param">pixel_scheme</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXLensMaps.prepare_mappers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXLensMaps.prepare_mappers" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to init any mapper objects</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="txpipe.maps.TXMainMaps">
<em class="property">class </em><code class="sig-prename descclassname">txpipe.maps.</code><code class="sig-name descname">TXMainMaps</code><span class="sig-paren">(</span><em class="sig-param">args</em>, <em class="sig-param">comm=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXMainMaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXMainMaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#txpipe.maps.TXSourceMaps" title="txpipe.maps.TXSourceMaps"><code class="xref py py-class docutils literal notranslate"><span class="pre">txpipe.maps.TXSourceMaps</span></code></a>, <a class="reference internal" href="#txpipe.maps.TXLensMaps" title="txpipe.maps.TXLensMaps"><code class="xref py py-class docutils literal notranslate"><span class="pre">txpipe.maps.TXLensMaps</span></code></a></p>
<p>Combined source and photometric lens maps, from the
same photometry catalog. This might be slightly faster than
running two maps separately, but it only works if the source
and lens catalogs are the same set of objects. Otherwise use
TXSourceMaps and TXLensMaps.</p>
<dl class="method">
<dt id="txpipe.maps.TXMainMaps.data_iterator">
<code class="sig-name descname">data_iterator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXMainMaps.data_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXMainMaps.data_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to create an iterator looping over
input data</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXMainMaps.finalize_mappers">
<code class="sig-name descname">finalize_mappers</code><span class="sig-paren">(</span><em class="sig-param">pixel_scheme</em>, <em class="sig-param">mappers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXMainMaps.finalize_mappers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXMainMaps.finalize_mappers" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to finalize their maps and return
a dictionary of (output_tag, map_name) -&gt; (pixels, values)</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXMainMaps.prepare_mappers">
<code class="sig-name descname">prepare_mappers</code><span class="sig-paren">(</span><em class="sig-param">pixel_scheme</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXMainMaps.prepare_mappers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXMainMaps.prepare_mappers" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to init any mapper objects</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="txpipe.maps.TXSourceMaps">
<em class="property">class </em><code class="sig-prename descclassname">txpipe.maps.</code><code class="sig-name descname">TXSourceMaps</code><span class="sig-paren">(</span><em class="sig-param">args</em>, <em class="sig-param">comm=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXSourceMaps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXSourceMaps" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#txpipe.maps.TXBaseMaps" title="txpipe.maps.TXBaseMaps"><code class="xref py py-class docutils literal notranslate"><span class="pre">txpipe.maps.TXBaseMaps</span></code></a></p>
<p>Make g1, g2, var(g1), var(g2), and lensing weight maps
from shear catalogs and tomography</p>
<dl class="method">
<dt id="txpipe.maps.TXSourceMaps.accumulate_maps">
<code class="sig-name descname">accumulate_maps</code><span class="sig-paren">(</span><em class="sig-param">pixel_scheme</em>, <em class="sig-param">data</em>, <em class="sig-param">mappers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXSourceMaps.accumulate_maps"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXSourceMaps.accumulate_maps" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to supply the next chunk “data” to
their mappers</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXSourceMaps.data_iterator">
<code class="sig-name descname">data_iterator</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXSourceMaps.data_iterator"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXSourceMaps.data_iterator" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to create an iterator looping over
input data</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXSourceMaps.finalize_mappers">
<code class="sig-name descname">finalize_mappers</code><span class="sig-paren">(</span><em class="sig-param">pixel_scheme</em>, <em class="sig-param">mappers</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXSourceMaps.finalize_mappers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXSourceMaps.finalize_mappers" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to finalize their maps and return
a dictionary of (output_tag, map_name) -&gt; (pixels, values)</p>
</dd></dl>

<dl class="method">
<dt id="txpipe.maps.TXSourceMaps.prepare_mappers">
<code class="sig-name descname">prepare_mappers</code><span class="sig-paren">(</span><em class="sig-param">pixel_scheme</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/txpipe/maps.html#TXSourceMaps.prepare_mappers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#txpipe.maps.TXSourceMaps.prepare_mappers" title="Permalink to this definition">¶</a></dt>
<dd><p>Subclasses must override to init any mapper objects</p>
</dd></dl>

</dd></dl>

</div>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="photoz_stack.html" class="btn btn-neutral float-left" title="photoz_stack" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="auxiliary_maps.html" class="btn btn-neutral float-right" title="Auxilliary maps" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2020, DESC.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>